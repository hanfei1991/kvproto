syntax = "proto3";
package encryptionpb;

message FileInfo {
    string path = 1;
    uint64 key_id = 2;
    bytes nonce = 3;
    bytes initial_count = 4;
}

message FileDictionary {
    repeated FileInfo files = 1;
}

enum EncryptionMethod {
    UNKNOWN = 0;
    PLAINTEXT = 1;
    AES128_CTR = 2;
    AES192_CTR = 3;
    AES256_CTR = 4;
}

message DataKey {
    bytes key = 1;
    uint64 id = 2;
    EncryptionMethod method = 3;
    uint64 creation_time = 4;
    bool was_exposed = 5;
}

message KeyDictionary {
    repeated DataKey keys = 1;
    FileInfo file_dict = 2;
    uint64 current_data_key = 3;
}

